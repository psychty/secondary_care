-- Aggregated total number of emergency admissions
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1213_hdis_10years
-- Finished episodes (3)
WHERE EPISTAT = '3'
-- Ordinary admission (1), day case (2) or maternity (5)
AND CLASSPAT IN ('1','2','5')
-- Emergency (non-elective) admission
AND ADMIMETH LIKE ('2%')
-- Finished admission episode 
AND FAE = 1
-- First episode of spell
AND EPIORDER = 1
-- Sussex LTLAs or Sussex CCGs of responsibility
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1314_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1415_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1516_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1617_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1718_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1819_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_1920_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_2021_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_2122_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD
UNION
SELECT COUNT(EPIKEY) AS Emergency_admissions, EXTRACT(MONTH FROM ADMIDATE) AS Month_of_admission, EXTRACT(YEAR FROM ADMIDATE) AS Year_of_admission, FYEAR AS Financial_year, SEX AS Sex, STARTAGE_CALC AS Age_years_calc, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD
FROM hdis_10years.hes_apc_2223_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065')
GROUP BY Month_of_admission, Year_of_admission, Financial_year, Sex, Age_years_calc, LSOA11CD, MSOA11CD