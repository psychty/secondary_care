-- !preview conn=DBI::dbConnect(RSQLite::SQLite())

-- Create a 10 year age group from STARTAGE_CALC

SELECT FYEAR,
    CASE WHEN STARTAGE_CALC BETWEEN 0 AND 9 THEN '0-9 years'
	       WHEN STARTAGE_CALC BETWEEN 10 AND  19 THEN '10-19 years'
         WHEN STARTAGE_CALC BETWEEN  20 AND  29 THEN '20-29 years'
	       WHEN STARTAGE_CALC BETWEEN  30 AND  39 THEN '30-39 years'
	       WHEN STARTAGE_CALC BETWEEN  40 AND  49 THEN '40-49 years'
	       WHEN STARTAGE_CALC BETWEEN  50 AND  59 THEN '50-59 years'
	       WHEN STARTAGE_CALC BETWEEN  60 AND  69 THEN '60-69 years'
	       WHEN STARTAGE_CALC BETWEEN  70 AND  79 THEN '70-79 years'
	       WHEN STARTAGE_CALC BETWEEN  80 AND  89 THEN '80-89 years'
	       WHEN STARTAGE_CALC BETWEEN 90 AND 120 THEN '90+'
		     ELSE 'Unknown' END AS Age_group_10,
      sum(FCE) AS FCE_Total
FROM hes.hes_apc_2021
WHERE RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E0700022', 'E07000229')		     
		
		          