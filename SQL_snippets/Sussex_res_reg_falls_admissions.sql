-- I want one query to extract all the data we need and then filter by the various definitions locally.
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1213_hdis_10years
-- Finished episodes (3)
WHERE EPISTAT = '3'
-- Ordinary admission (1), day case (2) or maternity (5)
AND CLASSPAT IN ('1','2','5')
-- Emergency (non-elective) admission
AND ADMIMETH LIKE ('2%')
-- Finished admission episode 
AND FAE = 1
-- First episode of spell
AND EPIORDER = 1
-- Sussex LTLAs or Sussex CCGs of responsibility
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
-- Conditions
-- any episode with a fall diagnosis code (W00 - W19), fragility fracture (M800,M808,M844), or propensity to fall due to problems of gait or mobility (R262, R268, R296)
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) -- We'll also pick up where the cause is fall but diagnosis codes do not include this code).
UNION -- this joins the results of queries together
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1314_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1415_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1516_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1617_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1718_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1819_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_1920_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_2021_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status, CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_2122_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]')) 
UNION 
SELECT FYEAR AS Financial_year, EPIKEY, PERSON_ID_DEID AS Person_ID, ADMIDATE AS Admission_date, ADMISORC AS Admission_source, ADMIMETH AS Admission_method, EPIDUR AS Episode_duration, EPIEND AS Episode_end_date, EPIORDER AS Episode_order, EPISTART AS Episode_start_date, EPISTAT AS Episode_status,  CAUSE_3, CAUSE_4, DIAG_3_CONCAT, DIAG_3_01, DIAG_3_02, DIAG_3_03, DIAG_3_04, DIAG_3_05, DIAG_3_06, DIAG_3_07, DIAG_3_08, DIAG_3_09, DIAG_3_10, DIAG_3_11, DIAG_3_12, DIAG_3_13, DIAG_3_14, DIAG_3_15, DIAG_3_16, DIAG_3_17, DIAG_3_18, DIAG_3_19, DIAG_3_20, DIAG_4_CONCAT, DIAG_4_01, DIAG_4_02, DIAG_4_03, DIAG_4_04, DIAG_4_05, DIAG_4_06, DIAG_4_07, DIAG_4_08, DIAG_4_09, DIAG_4_10, DIAG_4_11, DIAG_4_12, DIAG_4_13, DIAG_4_14, DIAG_4_15, DIAG_4_16, DIAG_4_17, DIAG_4_18, DIAG_4_19, DIAG_4_20, DIAG_COUNT,ETHNOS AS ETHNICITY, FAE, FCE, FDE, RESLADST_ONS, SEX, STARTAGE_CALC AS Age_years_calc, OPERTN_3_CONCAT, OPERTN_4_CONCAT, LSOA11 AS LSOA11CD, MSOA11 AS MSOA11CD, GPPRAC AS ODS_Code, CCG_RESPONSIBILITY AS CCG_of_responsibility, SPELBGIN AS Beginning_of_spell_indicator, SPELDUR AS Duration_of_spell, SPELDUR_CALC AS Duration_of_spell_excluding_regular_day_case, SPELEND AS End_of_spell_indicator, DISDATE AS Discharge_date, DISMETH AS Discharge_method, DISDEST AS Discharge_destination
FROM hdis_10years.hes_apc_2223_hdis_10years
WHERE EPISTAT = '3'
AND CLASSPAT IN ('1','2','5')
AND ADMIMETH LIKE ('2%')
AND FAE = 1
AND EPIORDER = 1
AND (RESLADST_ONS IN ('E07000223','E07000224','E07000225','E07000226','E07000227','E07000228', 'E07000229', 'E06000043', 'E07000061', 'E07000062', 'E07000063','E07000064','E07000065') OR CCG_RESPONSIBILITY IN ('09D', '09G', '09F', '09H', '09P', '09X', '99K', '70F', '97R'))
AND (DIAG_3_CONCAT RLIKE ('W[01]')
OR DIAG_4_CONCAT RLIKE ('M80[08]|M844|R26[28]|R296')
OR CAUSE_3 RLIKE ('W[01]'))